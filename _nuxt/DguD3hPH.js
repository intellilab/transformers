var ie=Object.defineProperty;var oe=(s,t,e)=>t in s?ie(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var ct=(s,t,e)=>oe(s,typeof t!="symbol"?t+"":t,e);import{m as gt,p as et,C as yt,o as A,c as L,a as b,G as re,A as Q,q as st,v as nt,F as ae,x as le,t as j,s as Ct,B as q,g as Ot,z as ft,H as Vt,r as Nt,d as X,b as ht,I as ce,y as Lt}from"./CNVyilSt.js";import{_ as bt,a as he,b as de,p as ue,Q as fe,d as be}from"./DUwYUV5O.js";import{j as Ht}from"./mbYHt68G.js";import{s as pe}from"./CJzgX8hy.js";import"./BosuxZz1.js";/*! @violentmonkey/shortcut v1.4.4 | ISC License */const kt=navigator.userAgent.includes("Macintosh"),xe=["m","c","s","a"],Ft={ctrl:"c",control:"c",shift:"s",alt:"a",meta:"m",cmd:"m"},me=bt({},Ft,{c:"c",s:"s",a:"a",m:"m",cm:kt?"m":"c",ctrlcmd:kt?"m":"c"}),ge={arrowup:"up",arrowdown:"down",arrowleft:"left",arrowright:"right",cr:"enter",escape:"esc"," ":"space"};function Kt(){return{children:new Map,shortcuts:new Set}}function ye(s,t,e){let n=s;for(const i of t){let o=n.children.get(i);o||(o=Kt(),n.children.set(i,o)),n=o}n.shortcuts.add(e)}function we(s,t){let e=s;for(const n of t)if(e=e.children.get(n),!e)break;return e}function ve(s,t,e){let n=s;const i=[n];for(const r of t){if(n=n.children.get(r),!n)return;i.push(n)}e?n.shortcuts.delete(e):n.shortcuts.clear();let o=i.length-1;for(;o>0&&(n=i[o],!(n.shortcuts.size||n.children.size));)i[o-1].children.delete(t[o-1]),o-=1}function _e(s){const t=[],e=(n,i=0)=>{for(const[o,r]of n.children.entries())t.push(["  ".repeat(i),o,r.shortcuts.size?` (${r.shortcuts.size})`:""].join("")),e(r,i+1)};return e(s),t.join(`
`)}class Se{constructor(t){this.listeners=[],this.value=t}get(){return this.value}set(t){this.value=t,this.listeners.forEach(e=>e(t))}subscribe(t){return this.listeners.push(t),t(this.value),()=>this.unsubscribe(t)}unsubscribe(t){const e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}}function P(s){const{caseSensitive:t,modifierState:e}=s;let{base:n}=s;(!t||n.length>1)&&(n=n.toLowerCase()),n=ge[n]||n;const i=[...xe.filter(o=>e[o]),n].filter(Boolean).join("-");return`${t?"":"i:"}${i}`}function Ae(s){const t=s.split(/-(.)/),e=[t[0]];for(let n=1;n<t.length;n+=2)e.push(t[n]+t[n+1]);return e}function Ce(s,t){const e=Ae(s),n=e.pop(),i={};for(const o of e){const r=me[o.toLowerCase()];if(!r)throw new Error(`Unknown modifier key: ${o}`);i[r]=!0}return t&&(t=!(i.a||i.s)),{base:n,modifierState:i,caseSensitive:t}}function Le(s){return Array.isArray(s)?s:s.split(/\s+/)}function He(s,t){return Le(s).map(e=>Ce(e,t))}function ke(s){return s.split("&&").map(t=>{if(t=t.trim(),!!t)return t[0]==="!"?{not:!0,field:t.slice(1).trim()}:{not:!1,field:t}}).filter(Boolean)}class ot{constructor(t){this._context={},this._conditionData={},this._data=[],this._root=Kt(),this.sequence=new Se([]),this._timer=0,this._reset=()=>{this._cur=void 0,this.sequence.set([]),this._resetTimer()},this.handleKey=e=>{if(!e.key||Ft[e.key.toLowerCase()])return;this._resetTimer();const n=[P({base:e.key,modifierState:{c:e.ctrlKey,m:e.metaKey},caseSensitive:!0}),P({base:e.code,modifierState:{c:e.ctrlKey,s:e.shiftKey,a:e.altKey,m:e.metaKey},caseSensitive:!1}),P({base:e.key,modifierState:{c:e.ctrlKey,s:e.shiftKey,a:e.altKey,m:e.metaKey},caseSensitive:!1})],i=this._handleKeyOnce(n,!1);i&&(e.preventDefault(),i===2&&this._reset()),this._timer=window.setTimeout(this._reset,this.options.sequenceTimeout)},this.options=bt({},ot.defaultOptions,t)}_resetTimer(){this._timer&&(window.clearTimeout(this._timer),this._timer=0)}_addCondition(t){let e=this._conditionData[t];if(!e){const n=ke(t);e={count:0,value:n,result:this._evalCondition(n)},this._conditionData[t]=e}e.count+=1}_removeCondition(t){const e=this._conditionData[t];e&&(e.count-=1,e.count||delete this._conditionData[t])}_evalCondition(t){return t.every(e=>{let n=this._context[e.field];return e.not&&(n=!n),n})}_checkShortcut(t){const e=t.condition&&this._conditionData[t.condition],n=!e||e.result;t.enabled!==n&&(t.enabled=n,this._enableShortcut(t))}_enableShortcut(t){(t.enabled?ye:ve)(this._root,t.sequence,t)}enable(){this.disable(),document.addEventListener("keydown",this.handleKey)}disable(){document.removeEventListener("keydown",this.handleKey)}register(t,e,n){const{caseSensitive:i,condition:o}=bt({caseSensitive:!1},n),a={sequence:He(t,i).map(l=>P(l)),condition:o,callback:e,enabled:!1,caseSensitive:i};return o&&this._addCondition(o),this._checkShortcut(a),this._data.push(a),()=>{const l=this._data.indexOf(a);l>=0&&(this._data.splice(l,1),o&&this._removeCondition(o),a.enabled=!1,this._enableShortcut(a))}}setContext(t,e){this._context[t]=e;for(const n of Object.values(this._conditionData))n.result=this._evalCondition(n.value);for(const n of this._data)this._checkShortcut(n)}_handleKeyOnce(t,e){var n,i;let o=this._cur;if((e||!o)&&(e=!0,o=this._root),o){let a;for(const l of t)if(a=we(o,[l]),a){this.sequence.set([...this.sequence.get(),l]);break}o=a}this._cur=o;const[r]=[...((n=o)==null?void 0:n.shortcuts)||[]];if(!e&&!r&&!((i=o)!=null&&i.children.size))return this._reset(),this._handleKeyOnce(t,!0);if(r){try{r.callback()}catch{}return 2}return this._cur?1:0}repr(){return _e(this._root)}}ot.defaultOptions={sequenceTimeout:500};const Ie={class:"snapshots"},Be={class:"flex mb-1"},Ee=["textContent"],Ue={class:"flex flex-col p-2 rounded t-border",style:{height:"70vh"}},$e={class:"form-group has-icon-right mb-2"},De={key:0,class:"flex-1 empty"},Oe={key:1,class:"flex-1 overflow-y-auto"},Ve=["textContent","onClick"],Ne=["onClick"],Fe=["textContent"],Ke={class:"mb-2"},Me=["readOnly"],je=["textContent"],Ge=gt({__name:"snapshot-panel",props:{title:{},modelValue:{},snapshots:{}},emits:["update:modelValue","pick"],setup(s,{emit:t}){const e=s,n=t,i=et({search:"",snapshots:[]}),o=yt(()=>{let c=e.snapshots.all.map((x,w)=>({data:x,index:w}));return i.search&&(c=c.filter(({data:x})=>x.name.includes(i.search))),c});function r(){i.modal={title:"Import data",content:"",message:"",error:!1}}function a(){const c=JSON.stringify(e.snapshots.all);i.modal={title:"Export data",content:c,readOnly:!0}}function l(c){var x;(x=i.modal)!=null&&x.readOnly&&c.target.select()}function d(){if(i.modal)try{const c=JSON.parse(i.modal.content);if(!Array.isArray(c))throw new Error("Invalid data.");e.snapshots.update(x=>[...x,...c]),i.modal.message="Data imported successfully.",i.modal.error=!1}catch(c){i.modal.error=!0,i.modal.message=`${c}`,console.error(c)}}function p({index:c,data:x}){n("update:modelValue",c===e.modelValue?-1:c),n("pick",x,c)}function u(c){if(e.snapshots.remove(c),c===e.modelValue)c=-1;else if(c<e.modelValue)c=e.modelValue-1;else return;n("update:modelValue",c)}function y(){i.modal=void 0}return(c,x)=>(A(),L("div",Ie,[b("div",Be,[re(c.$slots,"title",{},()=>[b("span",{textContent:j(c.title)},null,8,Ee)]),b("a",{href:"#",class:"ml-1 tooltip inline-block","data-tooltip":"Import",onClick:Q(r,["prevent"])},x[3]||(x[3]=[b("svg",{viewBox:"0 0 20 20",fill:"currentColor",class:"upload w-6 h-6"},[b("path",{"fill-rule":"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)])),b("a",{href:"#",class:"ml-1 tooltip inline-block","data-tooltip":"Export",onClick:Q(a,["prevent"])},x[4]||(x[4]=[b("svg",{viewBox:"0 0 20 20",fill:"currentColor",class:"download w-6 h-6"},[b("path",{"fill-rule":"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))]),b("div",Ue,[b("div",$e,[st(b("input",{type:"search",class:"form-input","onUpdate:modelValue":x[0]||(x[0]=w=>i.search=w)},null,512),[[nt,i.search]])]),o.value.length?(A(),L("div",Oe,[(A(!0),L(ae,null,le(o.value,w=>(A(),L("div",{class:Ct(["menu-item",{active:c.modelValue===w.index}]),key:w.index},[b("div",{class:"flex-1",textContent:j(w.data.name),onClick:Q(S=>p(w),["prevent"])},null,8,Ve),b("a",{href:"#",onClick:Q(S=>u(w.index),["prevent"])},x[6]||(x[6]=[b("svg",{viewBox:"0 0 20 20",fill:"currentColor",class:"x w-6 h-6"},[b("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,Ne)],2))),128))])):(A(),L("div",De,x[5]||(x[5]=[b("div",{class:"empty-title"},"None",-1)])))]),i.modal?(A(),L("div",{key:0,class:"modal",onClick:y},[b("div",{class:"modal-content",onClick:x[2]||(x[2]=Q(()=>{},["stop"]))},[b("div",{class:"mb-2",textContent:j(i.modal.title)},null,8,Fe),b("div",Ke,[st(b("textarea",{class:"form-input",rows:"10","onUpdate:modelValue":x[1]||(x[1]=w=>i.modal.content=w),readOnly:i.modal.readOnly,onClick:l},null,8,Me),[[nt,i.modal.content]])]),i.modal.message?(A(),L("span",{key:0,class:Ct(["mr-2",i.modal.error?"text-error":"text-success"]),textContent:j(i.modal.message)},null,10,je)):q("",!0),i.modal.readOnly?q("",!0):(A(),L("button",{key:1,class:"btn btn-primary",onClick:d}," Import and merge ")),b("button",{class:"btn",onClick:y},"Close")])])):q("",!0)]))}});//! otpauth 9.3.4 | (c) Héctor Molinero Fernández | MIT | https://github.com/hectorm/otpauth
//! noble-hashes 1.5.0 | (c) Paul Miller | MIT | https://github.com/paulmillr/noble-hashes
const Re=s=>{const t=new ArrayBuffer(8),e=new Uint8Array(t);let n=s;for(let i=7;i>=0&&n!==0;i--)e[i]=n&255,n-=e[i],n/=256;return e};function it(s){if(!Number.isSafeInteger(s)||s<0)throw new Error(`positive integer expected, not ${s}`)}function qe(s){return s instanceof Uint8Array||s!=null&&typeof s=="object"&&s.constructor.name==="Uint8Array"}function rt(s,...t){if(!qe(s))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(s.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${s.length}`)}function Te(s){if(typeof s!="function"||typeof s.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");it(s.outputLen),it(s.blockLen)}function T(s,t=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(t&&s.finished)throw new Error("Hash#digest() has already been called")}function Mt(s,t){rt(s);const e=t.outputLen;if(s.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ze=s=>new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4)),dt=s=>new DataView(s.buffer,s.byteOffset,s.byteLength),E=(s,t)=>s<<32-t|s>>>t,ut=(s,t)=>s<<t|s>>>32-t>>>0,It=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,We=s=>s<<24&4278190080|s<<8&16711680|s>>>8&65280|s>>>24&255;function Bt(s){for(let t=0;t<s.length;t++)s[t]=We(s[t])}function Je(s){if(typeof s!="string")throw new Error(`utf8ToBytes expected string, got ${typeof s}`);return new Uint8Array(new TextEncoder().encode(s))}function at(s){return typeof s=="string"&&(s=Je(s)),rt(s),s}class wt{clone(){return this._cloneInto()}}function W(s){const t=n=>s().update(at(n)).digest(),e=s();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>s(),t}class jt extends wt{update(t){return T(this),this.iHash.update(t),this}digestInto(t){T(this),rt(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:i,destroyed:o,blockLen:r,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=o,t.blockLen=r,t.outputLen=a,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}constructor(t,e){super(),this.finished=!1,this.destroyed=!1,Te(t);const n=at(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?t.create().update(n).digest():n);for(let r=0;r<o.length;r++)o[r]^=54;this.iHash.update(o),this.oHash=t.create();for(let r=0;r<o.length;r++)o[r]^=106;this.oHash.update(o),o.fill(0)}}const pt=(s,t,e)=>new jt(s,t).update(e).digest();pt.create=(s,t)=>new jt(s,t);function Qe(s,t,e,n){if(typeof s.setBigUint64=="function")return s.setBigUint64(t,e,n);const i=BigInt(32),o=BigInt(4294967295),r=Number(e>>i&o),a=Number(e&o),l=n?4:0,d=n?0:4;s.setUint32(t+l,r,n),s.setUint32(t+d,a,n)}const Gt=(s,t,e)=>s&t^~s&e,Rt=(s,t,e)=>s&t^s&e^t&e;class vt extends wt{update(t){T(this);const{view:e,buffer:n,blockLen:i}=this;t=at(t);const o=t.length;for(let r=0;r<o;){const a=Math.min(i-this.pos,o-r);if(a===i){const l=dt(t);for(;i<=o-r;r+=i)this.process(l,r);continue}n.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===i&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){T(this),Mt(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:i,isLE:o}=this;let{pos:r}=this;e[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>i-r&&(this.process(n,0),r=0);for(let u=r;u<i;u++)e[u]=0;Qe(n,i-8,BigInt(this.length*8),o),this.process(n,0);const a=dt(t),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=l/4,p=this.get();if(d>p.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<d;u++)a.setUint32(4*u,p[u],o)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:i,finished:o,destroyed:r,pos:a}=this;return t.length=i,t.pos=a,t.finished=o,t.destroyed=r,i%e&&t.buffer.set(n),t}constructor(t,e,n,i){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=dt(this.buffer)}}const Y=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),V=new Uint32Array(80);class Xe extends vt{get(){const{A:t,B:e,C:n,D:i,E:o}=this;return[t,e,n,i,o]}set(t,e,n,i,o){this.A=t|0,this.B=e|0,this.C=n|0,this.D=i|0,this.E=o|0}process(t,e){for(let l=0;l<16;l++,e+=4)V[l]=t.getUint32(e,!1);for(let l=16;l<80;l++)V[l]=ut(V[l-3]^V[l-8]^V[l-14]^V[l-16],1);let{A:n,B:i,C:o,D:r,E:a}=this;for(let l=0;l<80;l++){let d,p;l<20?(d=Gt(i,o,r),p=1518500249):l<40?(d=i^o^r,p=1859775393):l<60?(d=Rt(i,o,r),p=2400959708):(d=i^o^r,p=3395469782);const u=ut(n,5)+d+a+p+V[l]|0;a=r,r=o,o=ut(i,30),i=n,n=u}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,r=r+this.D|0,a=a+this.E|0,this.set(n,i,o,r,a)}roundClean(){V.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}constructor(){super(64,20,8,!1),this.A=Y[0]|0,this.B=Y[1]|0,this.C=Y[2]|0,this.D=Y[3]|0,this.E=Y[4]|0}}const Ye=W(()=>new Xe),Ze=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),N=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),F=new Uint32Array(64);class qt extends vt{get(){const{A:t,B:e,C:n,D:i,E:o,F:r,G:a,H:l}=this;return[t,e,n,i,o,r,a,l]}set(t,e,n,i,o,r,a,l){this.A=t|0,this.B=e|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=r|0,this.G=a|0,this.H=l|0}process(t,e){for(let u=0;u<16;u++,e+=4)F[u]=t.getUint32(e,!1);for(let u=16;u<64;u++){const y=F[u-15],c=F[u-2],x=E(y,7)^E(y,18)^y>>>3,w=E(c,17)^E(c,19)^c>>>10;F[u]=w+F[u-7]+x+F[u-16]|0}let{A:n,B:i,C:o,D:r,E:a,F:l,G:d,H:p}=this;for(let u=0;u<64;u++){const y=E(a,6)^E(a,11)^E(a,25),c=p+y+Gt(a,l,d)+Ze[u]+F[u]|0,w=(E(n,2)^E(n,13)^E(n,22))+Rt(n,i,o)|0;p=d,d=l,l=a,a=r+c|0,r=o,o=i,i=n,n=c+w|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,r=r+this.D|0,a=a+this.E|0,l=l+this.F|0,d=d+this.G|0,p=p+this.H|0,this.set(n,i,o,r,a,l,d,p)}roundClean(){F.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}constructor(){super(64,32,8,!1),this.A=N[0]|0,this.B=N[1]|0,this.C=N[2]|0,this.D=N[3]|0,this.E=N[4]|0,this.F=N[5]|0,this.G=N[6]|0,this.H=N[7]|0}}class Pe extends qt{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const ts=W(()=>new qt),es=W(()=>new Pe),tt=BigInt(2**32-1),xt=BigInt(32);function Tt(s,t=!1){return t?{h:Number(s&tt),l:Number(s>>xt&tt)}:{h:Number(s>>xt&tt)|0,l:Number(s&tt)|0}}function zt(s,t=!1){let e=new Uint32Array(s.length),n=new Uint32Array(s.length);for(let i=0;i<s.length;i++){const{h:o,l:r}=Tt(s[i],t);[e[i],n[i]]=[o,r]}return[e,n]}const ss=(s,t)=>BigInt(s>>>0)<<xt|BigInt(t>>>0),ns=(s,t,e)=>s>>>e,is=(s,t,e)=>s<<32-e|t>>>e,os=(s,t,e)=>s>>>e|t<<32-e,rs=(s,t,e)=>s<<32-e|t>>>e,as=(s,t,e)=>s<<64-e|t>>>e-32,ls=(s,t,e)=>s>>>e-32|t<<64-e,cs=(s,t)=>t,hs=(s,t)=>s,Wt=(s,t,e)=>s<<e|t>>>32-e,Jt=(s,t,e)=>t<<e|s>>>32-e,Qt=(s,t,e)=>t<<e-32|s>>>64-e,Xt=(s,t,e)=>s<<e-32|t>>>64-e;function ds(s,t,e,n){const i=(t>>>0)+(n>>>0);return{h:s+e+(i/2**32|0)|0,l:i|0}}const us=(s,t,e)=>(s>>>0)+(t>>>0)+(e>>>0),fs=(s,t,e,n)=>t+e+n+(s/2**32|0)|0,bs=(s,t,e,n)=>(s>>>0)+(t>>>0)+(e>>>0)+(n>>>0),ps=(s,t,e,n,i)=>t+e+n+i+(s/2**32|0)|0,xs=(s,t,e,n,i)=>(s>>>0)+(t>>>0)+(e>>>0)+(n>>>0)+(i>>>0),ms=(s,t,e,n,i,o)=>t+e+n+i+o+(s/2**32|0)|0,m={fromBig:Tt,split:zt,toBig:ss,shrSH:ns,shrSL:is,rotrSH:os,rotrSL:rs,rotrBH:as,rotrBL:ls,rotr32H:cs,rotr32L:hs,rotlSH:Wt,rotlSL:Jt,rotlBH:Qt,rotlBL:Xt,add:ds,add3L:us,add3H:fs,add4L:bs,add4H:ps,add5H:ms,add5L:xs},[gs,ys]=m.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(s=>BigInt(s))),K=new Uint32Array(80),M=new Uint32Array(80);class Yt extends vt{get(){const{Ah:t,Al:e,Bh:n,Bl:i,Ch:o,Cl:r,Dh:a,Dl:l,Eh:d,El:p,Fh:u,Fl:y,Gh:c,Gl:x,Hh:w,Hl:S}=this;return[t,e,n,i,o,r,a,l,d,p,u,y,c,x,w,S]}set(t,e,n,i,o,r,a,l,d,p,u,y,c,x,w,S){this.Ah=t|0,this.Al=e|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=r|0,this.Dh=a|0,this.Dl=l|0,this.Eh=d|0,this.El=p|0,this.Fh=u|0,this.Fl=y|0,this.Gh=c|0,this.Gl=x|0,this.Hh=w|0,this.Hl=S|0}process(t,e){for(let v=0;v<16;v++,e+=4)K[v]=t.getUint32(e),M[v]=t.getUint32(e+=4);for(let v=16;v<80;v++){const k=K[v-15]|0,I=M[v-15]|0,G=m.rotrSH(k,I,1)^m.rotrSH(k,I,8)^m.shrSH(k,I,7),J=m.rotrSL(k,I,1)^m.rotrSL(k,I,8)^m.shrSL(k,I,7),h=K[v-2]|0,f=M[v-2]|0,g=m.rotrSH(h,f,19)^m.rotrBH(h,f,61)^m.shrSH(h,f,6),B=m.rotrSL(h,f,19)^m.rotrBL(h,f,61)^m.shrSL(h,f,6),H=m.add4L(J,B,M[v-7],M[v-16]),O=m.add4H(H,G,g,K[v-7],K[v-16]);K[v]=O|0,M[v]=H|0}let{Ah:n,Al:i,Bh:o,Bl:r,Ch:a,Cl:l,Dh:d,Dl:p,Eh:u,El:y,Fh:c,Fl:x,Gh:w,Gl:S,Hh:U,Hl:$}=this;for(let v=0;v<80;v++){const k=m.rotrSH(u,y,14)^m.rotrSH(u,y,18)^m.rotrBH(u,y,41),I=m.rotrSL(u,y,14)^m.rotrSL(u,y,18)^m.rotrBL(u,y,41),G=u&c^~u&w,J=y&x^~y&S,h=m.add5L($,I,J,ys[v],M[v]),f=m.add5H(h,U,k,G,gs[v],K[v]),g=h|0,B=m.rotrSH(n,i,28)^m.rotrBH(n,i,34)^m.rotrBH(n,i,39),H=m.rotrSL(n,i,28)^m.rotrBL(n,i,34)^m.rotrBL(n,i,39),O=n&o^n&a^o&a,St=i&r^i&l^r&l;U=w|0,$=S|0,w=c|0,S=x|0,c=u|0,x=y|0,{h:u,l:y}=m.add(d|0,p|0,f|0,g|0),d=a|0,p=l|0,a=o|0,l=r|0,o=n|0,r=i|0;const R=m.add3L(g,H,St);n=m.add3H(R,f,B,O),i=R|0}({h:n,l:i}=m.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:r}=m.add(this.Bh|0,this.Bl|0,o|0,r|0),{h:a,l}=m.add(this.Ch|0,this.Cl|0,a|0,l|0),{h:d,l:p}=m.add(this.Dh|0,this.Dl|0,d|0,p|0),{h:u,l:y}=m.add(this.Eh|0,this.El|0,u|0,y|0),{h:c,l:x}=m.add(this.Fh|0,this.Fl|0,c|0,x|0),{h:w,l:S}=m.add(this.Gh|0,this.Gl|0,w|0,S|0),{h:U,l:$}=m.add(this.Hh|0,this.Hl|0,U|0,$|0),this.set(n,i,o,r,a,l,d,p,u,y,c,x,w,S,U,$)}roundClean(){K.fill(0),M.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}}class ws extends Yt{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const vs=W(()=>new Yt),_s=W(()=>new ws),Zt=[],Pt=[],te=[],Ss=BigInt(0),Z=BigInt(1),As=BigInt(2),Cs=BigInt(7),Ls=BigInt(256),Hs=BigInt(113);for(let s=0,t=Z,e=1,n=0;s<24;s++){[e,n]=[n,(2*e+3*n)%5],Zt.push(2*(5*n+e)),Pt.push((s+1)*(s+2)/2%64);let i=Ss;for(let o=0;o<7;o++)t=(t<<Z^(t>>Cs)*Hs)%Ls,t&As&&(i^=Z<<(Z<<BigInt(o))-Z);te.push(i)}const[ks,Is]=zt(te,!0),Et=(s,t,e)=>e>32?Qt(s,t,e):Wt(s,t,e),Ut=(s,t,e)=>e>32?Xt(s,t,e):Jt(s,t,e);function Bs(s,t=24){const e=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let r=0;r<10;r++)e[r]=s[r]^s[r+10]^s[r+20]^s[r+30]^s[r+40];for(let r=0;r<10;r+=2){const a=(r+8)%10,l=(r+2)%10,d=e[l],p=e[l+1],u=Et(d,p,1)^e[a],y=Ut(d,p,1)^e[a+1];for(let c=0;c<50;c+=10)s[r+c]^=u,s[r+c+1]^=y}let i=s[2],o=s[3];for(let r=0;r<24;r++){const a=Pt[r],l=Et(i,o,a),d=Ut(i,o,a),p=Zt[r];i=s[p],o=s[p+1],s[p]=l,s[p+1]=d}for(let r=0;r<50;r+=10){for(let a=0;a<10;a++)e[a]=s[r+a];for(let a=0;a<10;a++)s[r+a]^=~e[(a+2)%10]&e[(a+4)%10]}s[0]^=ks[n],s[1]^=Is[n]}e.fill(0)}class _t extends wt{keccak(){It||Bt(this.state32),Bs(this.state32,this.rounds),It||Bt(this.state32),this.posOut=0,this.pos=0}update(t){T(this);const{blockLen:e,state:n}=this;t=at(t);const i=t.length;for(let o=0;o<i;){const r=Math.min(e-this.pos,i-o);for(let a=0;a<r;a++)n[this.pos++]^=t[o++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:n,blockLen:i}=this;t[n]^=e,e&128&&n===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){T(this,!1),rt(t),this.finish();const e=this.state,{blockLen:n}=this;for(let i=0,o=t.length;i<o;){this.posOut>=n&&this.keccak();const r=Math.min(n-this.posOut,o-i);t.set(e.subarray(this.posOut,this.posOut+r),i),this.posOut+=r,i+=r}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return it(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Mt(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:e,suffix:n,outputLen:i,rounds:o,enableXOF:r}=this;return t||(t=new _t(e,n,i,r,o)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=o,t.suffix=n,t.outputLen=i,t.enableXOF=r,t.destroyed=this.destroyed,t}constructor(t,e,n,i=!1,o=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=n,this.enableXOF=i,this.rounds=o,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,it(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=ze(this.state)}}const lt=(s,t,e)=>W(()=>new _t(t,s,e)),Es=lt(6,144,224/8),Us=lt(6,136,256/8),$s=lt(6,104,384/8),Ds=lt(6,72,512/8),z=(()=>{if(typeof globalThis=="object")return globalThis;Object.defineProperty(Object.prototype,"__GLOBALTHIS__",{get(){return this},configurable:!0});try{if(typeof __GLOBALTHIS__<"u")return __GLOBALTHIS__}finally{delete Object.prototype.__GLOBALTHIS__}if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global})(),Os={SHA1:Ye,SHA224:es,SHA256:ts,SHA384:_s,SHA512:vs,"SHA3-224":Es,"SHA3-256":Us,"SHA3-384":$s,"SHA3-512":Ds},Vs=(s,t,e)=>{if(pt){const n=Os[s.toUpperCase()];if(!n)throw new TypeError("Unknown hash function");return pt(n,t,e)}else throw new Error("Missing HMAC function")},mt="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",Ns=s=>{s=s.replaceAll(" ","");let t=s.length;for(;s[t-1]==="=";)--t;s=(t<s.length?s.substring(0,t):s).toUpperCase();const e=new ArrayBuffer(s.length*5/8|0),n=new Uint8Array(e);let i=0,o=0,r=0;for(let a=0;a<s.length;a++){const l=mt.indexOf(s[a]);if(l===-1)throw new TypeError(`Invalid character found: ${s[a]}`);o=o<<5|l,i+=5,i>=8&&(i-=8,n[r++]=o>>>i)}return n},Fs=s=>{let t=0,e=0,n="";for(let i=0;i<s.length;i++)for(e=e<<8|s[i],t+=8;t>=5;)n+=mt[e>>>t-5&31],t-=5;return t>0&&(n+=mt[e<<5-t&31]),n},Ks=s=>{s=s.replaceAll(" ","");const t=new ArrayBuffer(s.length/2),e=new Uint8Array(t);for(let n=0;n<s.length;n+=2)e[n/2]=parseInt(s.substring(n,n+2),16);return e},Ms=s=>{let t="";for(let e=0;e<s.length;e++){const n=s[e].toString(16);n.length===1&&(t+="0"),t+=n}return t.toUpperCase()},js=s=>{const t=new ArrayBuffer(s.length),e=new Uint8Array(t);for(let n=0;n<s.length;n++)e[n]=s.charCodeAt(n)&255;return e},Gs=s=>{let t="";for(let e=0;e<s.length;e++)t+=String.fromCharCode(s[e]);return t},$t=z.TextEncoder?new z.TextEncoder:null,Dt=z.TextDecoder?new z.TextDecoder:null,Rs=s=>{if(!$t)throw new Error("Encoding API not available");return $t.encode(s)},qs=s=>{if(!Dt)throw new Error("Encoding API not available");return Dt.decode(s)},Ts=s=>{var t;if((t=z.crypto)!=null&&t.getRandomValues)return z.crypto.getRandomValues(new Uint8Array(s));throw new Error("Cryptography API not available")};class D{static fromLatin1(t){return new D({buffer:js(t).buffer})}static fromUTF8(t){return new D({buffer:Rs(t).buffer})}static fromBase32(t){return new D({buffer:Ns(t).buffer})}static fromHex(t){return new D({buffer:Ks(t).buffer})}get buffer(){return this.bytes.buffer}get latin1(){return Object.defineProperty(this,"latin1",{enumerable:!0,writable:!1,configurable:!1,value:Gs(this.bytes)}),this.latin1}get utf8(){return Object.defineProperty(this,"utf8",{enumerable:!0,writable:!1,configurable:!1,value:qs(this.bytes)}),this.utf8}get base32(){return Object.defineProperty(this,"base32",{enumerable:!0,writable:!1,configurable:!1,value:Fs(this.bytes)}),this.base32}get hex(){return Object.defineProperty(this,"hex",{enumerable:!0,writable:!1,configurable:!1,value:Ms(this.bytes)}),this.hex}constructor({buffer:t,size:e=20}={}){this.bytes=typeof t>"u"?Ts(e):new Uint8Array(t),Object.defineProperty(this,"bytes",{enumerable:!0,writable:!1,configurable:!1,value:this.bytes})}}const zs=(s,t)=>{{if(s.length!==t.length)throw new TypeError("Input strings must have the same length");let e=-1,n=0;for(;++e<s.length;)n|=s.charCodeAt(e)^t.charCodeAt(e);return n===0}};class _{static get defaults(){return{issuer:"",label:"OTPAuth",issuerInLabel:!0,algorithm:"SHA1",digits:6,counter:0,window:1}}static generate({secret:t,algorithm:e=_.defaults.algorithm,digits:n=_.defaults.digits,counter:i=_.defaults.counter}){const o=Vs(e,t.bytes,Re(i)),r=o[o.byteLength-1]&15;return(((o[r]&127)<<24|(o[r+1]&255)<<16|(o[r+2]&255)<<8|o[r+3]&255)%10**n).toString().padStart(n,"0")}generate({counter:t=this.counter++}={}){return _.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:t})}static validate({token:t,secret:e,algorithm:n,digits:i=_.defaults.digits,counter:o=_.defaults.counter,window:r=_.defaults.window}){if(t.length!==i)return null;let a=null;const l=d=>{const p=_.generate({secret:e,algorithm:n,digits:i,counter:d});zs(t,p)&&(a=d-o)};l(o);for(let d=1;d<=r&&a===null&&(l(o-d),!(a!==null||(l(o+d),a!==null)));++d);return a}validate({token:t,counter:e=this.counter,window:n}){return _.validate({token:t,secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:e,window:n})}toString(){const t=encodeURIComponent;return`otpauth://hotp/${this.issuer.length>0?this.issuerInLabel?`${t(this.issuer)}:${t(this.label)}?issuer=${t(this.issuer)}&`:`${t(this.label)}?issuer=${t(this.issuer)}&`:`${t(this.label)}?`}secret=${t(this.secret.base32)}&algorithm=${t(this.algorithm)}&digits=${t(this.digits)}&counter=${t(this.counter)}`}constructor({issuer:t=_.defaults.issuer,label:e=_.defaults.label,issuerInLabel:n=_.defaults.issuerInLabel,secret:i=new D,algorithm:o=_.defaults.algorithm,digits:r=_.defaults.digits,counter:a=_.defaults.counter}={}){this.issuer=t,this.label=e,this.issuerInLabel=n,this.secret=typeof i=="string"?D.fromBase32(i):i,this.algorithm=o.toUpperCase(),this.digits=r,this.counter=a}}class C{static get defaults(){return{issuer:"",label:"OTPAuth",issuerInLabel:!0,algorithm:"SHA1",digits:6,period:30,window:1}}static generate({secret:t,algorithm:e,digits:n,period:i=C.defaults.period,timestamp:o=Date.now()}){return _.generate({secret:t,algorithm:e,digits:n,counter:Math.floor(o/1e3/i)})}generate({timestamp:t=Date.now()}={}){return C.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:t})}static validate({token:t,secret:e,algorithm:n,digits:i,period:o=C.defaults.period,timestamp:r=Date.now(),window:a}){return _.validate({token:t,secret:e,algorithm:n,digits:i,counter:Math.floor(r/1e3/o),window:a})}validate({token:t,timestamp:e,window:n}){return C.validate({token:t,secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:e,window:n})}toString(){const t=encodeURIComponent;return`otpauth://totp/${this.issuer.length>0?this.issuerInLabel?`${t(this.issuer)}:${t(this.label)}?issuer=${t(this.issuer)}&`:`${t(this.label)}?issuer=${t(this.issuer)}&`:`${t(this.label)}?`}secret=${t(this.secret.base32)}&algorithm=${t(this.algorithm)}&digits=${t(this.digits)}&period=${t(this.period)}`}constructor({issuer:t=C.defaults.issuer,label:e=C.defaults.label,issuerInLabel:n=C.defaults.issuerInLabel,secret:i=new D,algorithm:o=C.defaults.algorithm,digits:r=C.defaults.digits,period:a=C.defaults.period}={}){this.issuer=t,this.label=e,this.issuerInLabel=n,this.secret=typeof i=="string"?D.fromBase32(i):i,this.algorithm=o.toUpperCase(),this.digits=r,this.period=a}}const Ws={class:"flex items-center"},Js=["textContent"],Qs=["textContent"],Xs=gt({__name:"totp-banner",props:{data:{}},setup(s){const t=s,e=et({count:0,value:""}),n=yt(()=>({...t.data,label:t.data.label||"",algorithm:t.data.algorithm||"sha1",digits:+(t.data.digits||6),period:+(t.data.period||30)}));let i;Ot(n,l=>{try{i=new C(l)}catch(d){console.error(d),i=null}o()},{immediate:!0});function o(){try{if(!i)throw new Error("Invalid TOTP");e.value=i.generate()}catch{e.value="??????"}}function r(){const l=Math.round(Date.now()/1e3),{period:d}=n.value;e.count=d-l%d,e.count===d&&o()}let a;return ft(()=>{a=window.setInterval(r,1e3),r(),o()}),Vt(()=>{clearInterval(a)}),(l,d)=>(A(),L("div",Ws,[b("div",{class:"p-2 text-green-600",textContent:j(e.value)},null,8,Js),b("div",{class:"w-6 h-6 leading-6 text-center text-xs border border-gray-400 rounded-full",textContent:j(e.count)},null,8,Qs)]))}});class ee{constructor(t){this.key=t}load(t){let e=t;try{const n=localStorage.getItem(this.key);n!=null&&(e=JSON.parse(n))}catch{}return e}dump(t){localStorage.setItem(this.key,JSON.stringify(t))}}class Ys{constructor(t){ct(this,"storage");ct(this,"data");this.storage=new ee(t),this.data=Nt(this.storage.load([])),this.normalize()}get all(){return this.data.value}normalize(){const t=[...this.data.value].sort((e,n)=>this.compare(e,n));this.data.value=t}compare(t,e){const n=`${t.name||""}`,i=`${e.name||""}`;return n.localeCompare(i,"zh-CN")}dump(){this.storage.dump(this.data.value)}remove(t){const e=[...this.data.value.slice(0,t),...this.data.value.slice(t+1)];this.data.value=e,this.dump()}updateItem(t,e){const n=[...this.data.value];return t>=0?n[t]=e:(t=n.length,n.push(e)),this.data.value=n,this.dump(),t}update(t){this.data.value=t(this.data.value),this.normalize(),this.dump()}}function Zs(s){const t=JSON.parse(decodeURI(s));Object.entries(t).forEach(([e,n])=>{localStorage.setItem(e,n)})}function Ps(){const{length:s}=localStorage,t={};for(let e=0;e<s;e+=1){const n=localStorage.key(e);t[n]=localStorage.getItem(n)}return encodeURI(JSON.stringify(t))}window.transformers={import:Zs,export:Ps};const tn={class:"flex items-start"},en={class:"flex-1 min-w-0"},sn={class:"flex"},nn={class:"flex-1 min-w-0 mr-4"},on={class:"flex-1 mr-4"},rn=["value"],an={class:"mt-4"},ln=["textContent"],cn={class:"mt-4 mr-4"},hn={class:"mt-4 mr-4"},dn={class:"mt-4"},un=["disabled"],fn=["disabled"],bn=["disabled"],pn={key:0},xn=["value"],Sn=gt({__name:"url-builder",setup(s){const t=new ot,e=new ee("url-builder/settings"),n=e.load({}),i=new Ys("url-builder/snapshots"),o=et({config:"",url:"",label:"",name:""}),r=et({activeIndex:-1}),a=yt(()=>({...be,data:o.url})),l=Nt();let d=!1,p=!1;Ot(a,()=>{l.value=void 0});const u=[];ft(()=>{t.enable(),u.push(t.register("ctrlcmd-s",()=>c())),S()}),Vt(()=>{u.forEach(h=>h())});function y(h){const{label:f}=o;if(f){const g=h.getContext("2d");g.clearRect(0,300,300,40),g.font='24px -apple-system, system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Droid Sans, Helvetica Neue, "Segoe UI", Roboto, "Helvetica Neue", sans-serif',g.fillStyle="dodgerblue",g.textAlign="center",g.fillText(f,150,330)}}function c(h){const{name:f,label:g,config:B}=o,H={name:f||"No name",data:{name:f,label:g,config:B}};r.activeIndex=i.updateItem(h?-1:r.activeIndex,H),pe("Saved")}function x(){const h=new URLSearchParams(window.location.hash.slice(1)),f={name:h.get("name")||"",label:h.get("label")||"",url:h.get("url")};f.url&&(r.activeIndex=-1,Object.assign(o,f),$(f.url),window.location.hash="")}function w(){const{name:h,label:f,config:g}=o;n.autoSaved={name:h,label:f,config:g,activeIndex:r.activeIndex},e.dump(n)}function S(){const h=n.autoSaved;G(h),r.activeIndex=(h==null?void 0:h.activeIndex)??-1}function U(h,f=!1){var B,H;if(d||h===o.config&&!f)return;d=!0,o.config=h;let g;try{r.error=void 0,g=h?Ht.load(h):void 0}catch(O){r.error=`${O}`,console.error(O)}((B=g==null?void 0:g.payload)==null?void 0:B.type)==="totp"&&((H=g.query)!=null&&H.secret)?r.totp={...g.payload,...g.query}:r.totp=void 0,w(),p||$(g&&de(g)||""),d=!1}function $(h){if(!p){if(p=!0,o.url=h,!d){const f=ue(h);U(Ht.dump(f))}p=!1}}function v(h){$(h.target.value)}function k(){const{origin:h,pathname:f,search:g}=window.location,{name:B,label:H,url:O}=o;let R=Object.entries({name:B,label:H,url:O}).map(([ne,At])=>At&&[ne,At].map(encodeURIComponent).join("=")).filter(Boolean).join("&");R=`${R}&_=`;const se=`${h}${f}${g}#${R}`;l.value={url:se}}function I({data:h}){Object.assign(o,{name:h.name,label:h.label}),U(h.config)}function G(h){r.activeIndex=-1,Object.assign(o,{name:(h==null?void 0:h.name)||"",label:(h==null?void 0:h.label)||""}),U((h==null?void 0:h.config)||"",!0)}function J(h){h.target.select()}return ft(()=>{x()}),(h,f)=>(A(),L("div",null,[f[11]||(f[11]=b("h1",null,"URL Builder",-1)),b("section",null,[b("div",tn,[b("div",en,[b("div",sn,[b("div",nn,[b("div",null,[f[7]||(f[7]=b("div",{class:"mb-1"},[X(" Parsed data "),b("span",{class:"ml-1 text-sm"},"(in Yaml)")],-1)),ht(he,{class:"t-code",lang:"yaml",modelValue:o.config,"onUpdate:modelValue":f[0]||(f[0]=g=>o.config=g)},null,8,["modelValue"])])]),b("div",on,[b("div",null,[f[8]||(f[8]=b("div",{class:"mb-1"},[X(" URL "),b("span",{class:"ml-1 text-sm"},[X("(Special protocols like "),b("code",null,"otpauth:"),X(", "),b("code",null,"vmess:"),X(" are supported)")])],-1)),b("textarea",{class:"form-input",value:o.url,onInput:v,rows:"4"},null,40,rn),r.totp?(A(),ce(Xs,{key:0,data:r.totp},null,8,["data"])):q("",!0)]),b("div",an,[ht(Lt(fe),{class:"qrcode",width:300,height:o.label?340:300,options:a.value,onUpdated:y},null,8,["height","options"])]),r.error?(A(),L("div",{key:0,class:"mt-2 text-white error",textContent:j(r.error)},null,8,ln)):q("",!0)])]),b("div",cn,[f[9]||(f[9]=b("label",{class:"mb-1"},"Label",-1)),st(b("input",{class:"form-input","onUpdate:modelValue":f[1]||(f[1]=g=>o.label=g)},null,512),[[nt,o.label]])]),b("div",hn,[f[10]||(f[10]=b("label",{class:"mb-1"},"Name",-1)),st(b("input",{class:"form-input","onUpdate:modelValue":f[2]||(f[2]=g=>o.name=g)},null,512),[[nt,o.name]])]),b("div",dn,[b("button",{class:"mr-2 mb-1",onClick:f[3]||(f[3]=g=>G())},"Reset"),b("button",{class:"mr-2 mb-1",disabled:!o.config,onClick:f[4]||(f[4]=g=>c())}," Save ",8,un),b("button",{class:"mr-2 mb-1",disabled:!o.config,onClick:f[5]||(f[5]=g=>c(!0))}," Save as New ",8,fn),b("button",{class:"mr-2 mb-1",disabled:!o.config,onClick:k}," Share ",8,bn)]),l.value?(A(),L("div",pn,[b("input",{class:"form-input",readonly:"",value:l.value.url,onClick:J},null,8,xn)])):q("",!0)]),ht(Ge,{title:"Snapshots",modelValue:r.activeIndex,"onUpdate:modelValue":f[6]||(f[6]=g=>r.activeIndex=g),snapshots:Lt(i),onPick:I},null,8,["modelValue","snapshots"])])])]))}});export{Sn as default};
