import{m as M,p as O,r as B,g as $,C as E,o as l,c as i,a as n,A as C,B as k,F as m,x as f,q as c,v as _,t as r,s as N,D as A,E as D}from"./CNVyilSt.js";const F={class:"flex mb-2"},j=["onClick"],H={class:"flex"},R=["textContent"],S=["onClick"],q=["textContent"],I={class:"mb-2"},T=["textContent","onClick"],G={key:0,class:"text-gray"},J=["textContent"],K={key:0,class:"text-left"},Q={key:0},W={class:"block"},X=["onUpdate:modelValue"],Y=["textContent"],Z={key:1},ee=["textContent"],te={key:0},ne=["value","onUpdate:modelValue"],oe=["textContent"],se=["onUpdate:modelValue"],le=["onUpdate:modelValue"],ie={key:1,class:"empty"},de=M({__name:"pipe-section",props:{pipeList:{},errorPipe:{},modelValue:{}},emits:["update:modelValue"],setup(x,{emit:b}){const p=x,v=b,s=O({search:""}),g=B([]);$(()=>p.modelValue,o=>{g.value=o});const h=E(()=>{let o=p.pipeList;const t=s.search.toLowerCase();return t&&(o=o.filter(e=>e.meta.name.toLowerCase().includes(t))),o});function y(o){const{options:t,normalizedOptions:e}=o.meta.options.reduce((d,a)=>{if(a.default!=null){let u=a.default;d.options[a.name]=u,a.normalize&&(u=a.normalize(u)),d.normalizedOptions[a.name]=u}return d},{options:{},normalizedOptions:{}});v("update:modelValue",[...p.modelValue,{name:o.meta.name,options:t,normalizedOptions:e}])}function V(o){const t=Object.keys(o).map(e=>`${e}=${o[e]}`).join(";");return t?`[${t}]`:""}function z(o){v("update:modelValue",[...p.modelValue.slice(0,o),...p.modelValue.slice(o+1)])}function L(){v("update:modelValue",[])}function w(o){const t=p.pipeList.find(e=>e.meta.name===o.name);s.editing={pipe:t,value:o,options:{...o.options}}}function U(){s.editing.value.options=s.editing.options,s.editing.value.normalizedOptions=s.editing.pipe.meta.options.reduce((o,t)=>{let e=s.editing.options[t.name];return e!=null&&t.normalize&&(e=t.normalize(e)),o[t.name]=e,o},{}),s.editing=null,v("update:modelValue",[...p.modelValue])}return(o,t)=>(l(),i("section",null,[n("div",F,[t[3]||(t[3]=n("h3",null,"Applied pipes",-1)),g.value.length?(l(),i("a",{key:0,class:"ml-4",href:"#",onClick:C(L,["prevent"])},t[2]||(t[2]=[n("svg",{viewBox:"0 0 20 20",fill:"currentColor",class:"trash w-6 h-6"},[n("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)]))):k("",!0)]),n("div",null,[t[6]||(t[6]=n("div",{class:"tool-string-pipe mr-2 disabled"},"Input",-1)),(l(!0),i(m,null,f(g.value,(e,d)=>(l(),i(m,{key:d},[t[5]||(t[5]=n("span",{class:"mr-2"},"→",-1)),n("div",{class:N(["tool-string-pipe mr-2 mb-2",{"bg-red-300":e.name===o.errorPipe}]),onClick:a=>w(e)},[n("div",H,[n("strong",{textContent:r(e.name),class:"flex-1 mr-2"},null,8,R),n("a",{href:"#",onClick:C(a=>z(d),["prevent","stop"])},t[4]||(t[4]=[n("svg",{viewBox:"0 0 20 20",fill:"currentColor",class:"x w-6 h-6"},[n("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,S)]),n("span",{class:"text-xs",textContent:r(V(e.options))},null,8,q)],10,j)],64))),128)),t[7]||(t[7]=n("span",{class:"mr-2"},"→",-1)),t[8]||(t[8]=n("div",{class:"tool-string-pipe disabled"},"Output",-1))]),t[10]||(t[10]=n("h3",{class:"mt-2 mb-1"},"Pipes",-1)),n("div",I,[c(n("input",{type:"search",class:"form-input",placeholder:"Filter pipes...","onUpdate:modelValue":t[0]||(t[0]=e=>s.search=e)},null,512),[[_,s.search]])]),(l(!0),i(m,null,f(h.value,(e,d)=>(l(),i("button",{key:d,class:"mr-2 mb-2",textContent:r(e.meta.name),onClick:a=>y(e)},null,8,T))),128)),h.value.length?k("",!0):(l(),i("p",G,"No pipe is found.")),s.editing?(l(),i("div",{key:1,class:"modal",onClick:U},[n("div",{class:"modal-content",onClick:t[1]||(t[1]=C(()=>{},["stop"]))},[n("div",{class:"font-bold mb-2",textContent:r(s.editing.pipe.meta.name)},null,8,J),s.editing.pipe.meta.options.length?(l(),i("div",K,[(l(!0),i(m,null,f(s.editing.pipe.meta.options,(e,d)=>(l(),i("div",{key:d,class:"mb-2"},[e.type==="checkbox"?(l(),i("div",Q,[n("label",W,[c(n("input",{type:"checkbox","onUpdate:modelValue":a=>s.editing.options[e.name]=a},null,8,X),[[A,s.editing.options[e.name]]]),n("span",{textContent:r(e.description)},null,8,Y)])])):(l(),i("div",Z,[n("label",{class:"block",textContent:r(e.description)},null,8,ee),e.type==="radio"?(l(),i("div",te,[(l(!0),i(m,null,f(e.choices,(a,u)=>(l(),i("label",{class:"block",key:u},[c(n("input",{type:"radio",value:a.value,"onUpdate:modelValue":P=>s.editing.options[e.name]=P},null,8,ne),[[D,s.editing.options[e.name]]]),n("span",{textContent:r(a.label)},null,8,oe)]))),128))])):e.type==="number"?c((l(),i("input",{key:1,class:"form-input",type:"number","onUpdate:modelValue":a=>s.editing.options[e.name]=a},null,8,se)),[[_,s.editing.options[e.name],void 0,{number:!0}]]):c((l(),i("input",{key:2,class:"form-input","onUpdate:modelValue":a=>s.editing.options[e.name]=a},null,8,le)),[[_,s.editing.options[e.name]]])]))]))),128))])):(l(),i("div",ie,t[9]||(t[9]=[n("div",{class:"empty-title"},"No options available",-1)])))])])):k("",!0)]))}});export{de as _};
